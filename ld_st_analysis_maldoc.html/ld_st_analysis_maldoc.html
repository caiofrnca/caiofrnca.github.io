<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>LetsDefend - Malicious Document Analysis</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="17b01692-defe-801b-9c14-dae0305666d8" class="page sans"><header><h1 class="page-title"><strong>LetsDefend - Malicious Document Analysis</strong></h1><p class="page-description"></p></header><div class="page-body"><p id="17c01692-defe-8053-b384-d0c093313e4b" class="">As part of my ongoing journey in cybersecurity, I engaged in <strong>malicious document static analysis</strong> through the Let&#x27;sDefend SOC Career Path course. This hands-on activity involved identifying, analyzing, and interpreting malicious components embedded in a document, emphasizing the importance of proactive detection and mitigation in cybersecurity operations.</p><h3 id="17c01692-defe-802f-99aa-f67fdfce8a4e" class=""><strong>Overview</strong></h3><p id="17c01692-defe-8012-9f9e-d53df5e49197" class="">This activity focused on <strong>malware delivery via macros</strong> embedded in Microsoft Office documents, a common technique used by attackers to execute malicious payloads. By utilizing a combination of open-source and forensic tools, I gained proficiency in detecting and analyzing malicious document artifacts, including:</p><ul id="17c01692-defe-803b-a4a9-c28c76296767" class="bulleted-list"><li style="list-style-type:disc">Identifying <strong>malicious VBA macros</strong> and their execution methods.</li></ul><ul id="17c01692-defe-8086-a936-fe9f09ce729f" class="bulleted-list"><li style="list-style-type:disc">Extracting <strong>hidden content</strong> and <strong>metadata</strong> to uncover suspicious activity.</li></ul><ul id="17c01692-defe-803f-baf6-e31546a5d0bc" class="bulleted-list"><li style="list-style-type:disc">Analyzing document behavior through hash verification and threat intelligence platforms like <strong>VirusTotal</strong>.</li></ul><ul id="17c01692-defe-8003-91d4-c453b784897e" class="bulleted-list"><li style="list-style-type:disc">Leveraging tools like <strong>ExifTool</strong>, <strong>strings</strong>, <strong>xorsearch</strong>, and <strong>Oletools</strong> for in-depth static and dynamic analysis.</li></ul><h3 id="17c01692-defe-80c7-8550-cfdad9fb898d" class=""><strong>Significance</strong></h3><p id="17c01692-defe-80d4-bb13-ee89ad45b2ed" class="">The project demonstrated the real-world application of cybersecurity methodologies to combat evolving threats in document-based malware. It honed my ability to:</p><ul id="17c01692-defe-80c5-9d51-c4fcaa207fef" class="bulleted-list"><li style="list-style-type:disc">Detect <strong>macro-based malware</strong> used for phishing campaigns and data exfiltration.</li></ul><ul id="17c01692-defe-80a7-9bea-d3e3dc61c273" class="bulleted-list"><li style="list-style-type:disc">Investigate malicious payloads and obfuscation techniques deployed by attackers.</li></ul><ul id="17c01692-defe-8057-b219-c0a13c54ae6b" class="bulleted-list"><li style="list-style-type:disc">Provide actionable insights to mitigate document-based attacks, a critical skill in SOC and incident response roles.</li></ul><hr id="17c01692-defe-8041-a6bd-d469355ede81"/><p id="ae3f3b63-a21a-44a5-9df2-0ce4b989b680" class="">Attackers have taken advantage of documents by using macros. And macros have been used by malicious actors to deliver malware.</p><blockquote id="3656107f-9a57-4c70-a38c-d844f85f9855" class=""><strong>macros</strong> refer to <strong>scripts or small programs embedded within documents</strong> (such as Word, Excel, or PowerPoint files) that are written in <strong>VBA (Visual Basic for Applications)</strong>. Macros are designed to automate repetitive tasks, like formatting data or generating reports, but attackers often exploit them for malicious purposes.</blockquote><h3 id="ac94f86d-2506-4ec5-acfe-2b7dcaf84463" class=""><strong>How Macros Are Used in Malicious Documents</strong>:</h3><ol type="1" id="17711f64-c63c-4d0e-b8ef-e03f23406aac" class="numbered-list" start="1"><li><strong>Execution of Malicious Code</strong>:<ul id="51db97e7-ce5a-4a70-a969-1d9be6500f47" class="bulleted-list"><li style="list-style-type:disc">Attackers embed VBA scripts into documents that execute when the document is opened or specific actions (like enabling macros) are performed.</li></ul><ul id="7d276cff-123b-492e-a72a-efc56777e695" class="bulleted-list"><li style="list-style-type:disc">These scripts can download and execute malware, steal data, or perform other harmful actions.</li></ul></li></ol><ol type="1" id="295b1371-46b2-4989-bdce-b7950187985f" class="numbered-list" start="2"><li><strong>Social Engineering</strong>:<ul id="5bc40040-c114-4bcf-a160-14247b15f7b9" class="bulleted-list"><li style="list-style-type:disc">Users are tricked into enabling macros by enticing them with messages like:<blockquote id="9be2b5b1-7dfd-46a5-a536-d4e345be69bf" class="">&quot;This document contains protected content. Enable macros to view it.&quot;</blockquote></li></ul><ul id="c62cb464-a909-4b5e-afab-3af680574f76" class="bulleted-list"><li style="list-style-type:disc">Once enabled, the macro executes the malicious payload.</li></ul></li></ol><ol type="1" id="03edab01-a396-413a-b13d-ddb175f07a51" class="numbered-list" start="3"><li><strong>Common Attack Techniques</strong>:<ul id="a641c7b7-360d-4e0e-9562-11ac3b6eb3ea" class="bulleted-list"><li style="list-style-type:disc"><strong>Downloading Malware</strong>: The macro connects to a remote server to download malware (e.g., ransomware, Trojans).</li></ul><ul id="be9074a1-0b80-47bd-ab7d-170f84ee3d7b" class="bulleted-list"><li style="list-style-type:disc"><strong>Exfiltrating Data</strong>: The macro collects sensitive information and sends it to an attacker.</li></ul><ul id="04b44977-dbbd-4b8a-a507-fe5b0e4147c7" class="bulleted-list"><li style="list-style-type:disc"><strong>Spawning Shells</strong>: Macros can be used to execute system commands or open a backdoor to give attackers control.</li></ul></li></ol><hr id="17c01692-defe-80be-a1d9-c5b3b8b1c3b2"/><h2 id="09274451-1097-44d5-8ba3-714230801e4f" class=""><strong>Static Malicious Document Analysis</strong></h2><p id="aad3faa1-ffdf-45c5-a0bd-d1373c4662a4" class="">
</p><p id="9f6bab56-519c-4cda-8849-bda20c5f20ef" class="">File link: <a href="https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/MaliciousDocumentAnalysis-Malware-Samples/PO-465514-180820.doc.zip">https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/MaliciousDocumentAnalysis-Malware-Samples/PO-465514-180820.doc.zip</a></p><p id="aadf32e2-aa9c-4ace-8262-e0b8917621ca" class="">Pass: infected</p><p id="ac3ddfda-8b9a-4bfc-97c9-fef2ec64d967" class="">⚠️ BE CAREFUL, THIS IS A REAL MALWARE</p><h2 id="c067032d-99af-4cf8-abbf-c87c9b79b192" class="">1 - Finding the MD5 value of the &quot;/root/Desktop/QuestionFiles/PO-465514-180820.doc&quot; file</h2><ul id="2822e857-14c8-4f85-8dc7-ffbb993fb0af" class="bulleted-list"><li style="list-style-type:disc">Open the file on terminal and type the command:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="44e63216-5502-40e4-995d-efd82ea71df7" class="code"><code class="language-JavaScript"># md5sum “file name”</code></pre></li></ul><p id="714aa6f9-3a3d-4e19-b3ee-a5e22b82969f" class="">Also works for SHA256:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3c108530-df46-4dc0-954c-f32b40124296" class="code"><code class="language-JavaScript"># sha256sum “file name”</code></pre><figure id="8d0b8bb4-090b-4683-bf7d-d572ad6f1b4c" class="image"><a href="image.png"><img style="width:622.96875px" src="image.png"/></a></figure><hr id="f33446c8-0635-47f6-bd6b-90372993171e"/><p id="e8110e89-84bd-47d5-bd98-64600106b37f" class="">
</p><h2 id="3d9c5742-6895-4a82-9c30-40be49e268c5" class="">2 - Checking the hash on the cyber community :</h2><ul id="968eed99-51f1-4a48-9a10-14388f152169" class="bulleted-list"><li style="list-style-type:disc">VirusTotal search: 50/62 flagged as malicious:</li></ul><ul id="85cf4c4f-ac4a-463d-b70a-8fb614146a83" class="bulleted-list"><li style="list-style-type:disc">Also, I checked the behavior, relations and details of this file.</li></ul><figure id="6f6426d3-b8c4-47d9-8547-1e03172125c4" class="image"><a href="image%201.png"><img style="width:622.984375px" src="image%201.png"/></a></figure><p id="b51c37e9-2c32-4d44-909e-c3e69d0ad1f4" class="">There are other information channels (mentioned below), but in order to reduce the size of the activity, I only kept VirusTotal. ALWAYS remember to get as many sources/info as possible!</p><ul id="17c01692-defe-80c9-8c21-fcfe74f4cb8f" class="bulleted-list"><li style="list-style-type:disc"><a href="https://app.any.run/">AnyRun</a></li></ul><ul id="17c01692-defe-806c-9a11-f54b10883f6c" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.virustotal.com/">VirusTotal</a></li></ul><ul id="17c01692-defe-808a-90af-d5f528253e7a" class="bulleted-list"><li style="list-style-type:disc"><a href="https://urlhaus.abuse.ch/browse/">URLHouse</a></li></ul><ul id="17c01692-defe-80fa-9a44-cc42193782a2" class="bulleted-list"><li style="list-style-type:disc"><a href="https://urlscan.io/">URLScan</a></li></ul><ul id="17c01692-defe-8003-9a48-ec08ee143622" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.hybrid-analysis.com/">HybridAnalysis</a></li></ul><h2 id="7c316a99-09b1-42b7-a1bf-c5db6e1b5f8e" class="">3 - Next step, tool called exiftool, </h2><p id="7de2bde8-9cb5-41ac-b9be-ce94e26ffd35" class="">which shows loads of file information, we should pay attention for any suspicious information like data creation/modification, type, language, template, size, etc:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3a5a14b4-fdde-4be5-8e95-93eb9791413e" class="code"><code class="language-JavaScript"># exiftool “File name”</code></pre><figure id="90759d72-9e2d-4dbd-aa9a-77f43bf17dc2" class="image"><a href="image%202.png"><img style="width:622.984375px" src="image%202.png"/></a></figure><p id="22cfdd96-c3ba-49ce-ada8-ce5c288e93e7" class="">Details that caught my attention</p><ul id="fb2bcd43-28d9-494e-8d19-79fb64d498aa" class="bulleted-list"><li style="list-style-type:disc">Creation date 2020, modification date 2023 !?</li></ul><ul id="6f27715f-794f-408c-8ba4-cf54d2ce5fa6" class="bulleted-list"><li style="list-style-type:disc">Template as file.dotm ( m basically means macro, which is usually inserted as malicious repetitive tasks on files.</li></ul><ul id="0eb504db-1d81-4412-bd9a-04f2e7ed6ba0" class="bulleted-list"><li style="list-style-type:disc">File permissions: all ?!</li></ul><hr id="85bfa93e-907a-4c59-87c6-423e9de6d489"/><h2 id="236fbd6f-6135-4ebf-87e6-98d86869c246" class="">4 - Strings tool is the next tool to be explored. </h2><p id="e0ff6696-1c4b-4a24-8bdd-0cc6d75ea025" class=""><br/>The <br/><code>strings</code> tool in Linux is used to extract printable ASCII or Unicode strings from binary files, which are often filled with unreadable or non-human-readable data. This tool is particularly useful for analyzing executables, documents, or other binary files to uncover potentially suspicious or embedded content.</p><h3 id="43be6e98-9f89-47ba-b705-c0686bb98e85" class=""><strong>Basic Usage of </strong><code><strong>strings</strong></code></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="231e08dd-4919-480f-a33c-a2dc43ab77bd" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">strings [options] &lt;file&gt;</code></pre><h3 id="fd8c34d6-b30e-44af-800c-74c51665c8a5" class=""><strong>Extract Strings from a File</strong>:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="93164123-da07-4362-a263-cf42b685649d" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">strings suspicious_file.exe</code></pre><ul id="66692c49-6c3b-42ea-96d7-d7e7c6040a85" class="bulleted-list"><li style="list-style-type:disc">This will display all human-readable strings (e.g., text, URLs, commands) found in the binary.</li></ul><figure id="8a9e43c3-0a0f-4efb-b08c-e7efcd8ccf62" class="image"><a href="image%203.png"><img style="width:622.984375px" src="image%203.png"/></a></figure><p id="4d86a0e6-6e63-404e-b453-eef188a7547c" class="">
</p><p id="fac02061-2c5d-41a5-9a75-5b31e3bfae89" class=""><strong>Search for Specific Patterns:</strong><br/>Combine <br/><code>strings</code> with <code>grep</code> to filter for relevant information:<div class="indented"><p id="7656bc30-3ee5-4453-95aa-4dc5000ff7a3" class="">What to look for:</p><ul id="9b0a78ec-5406-4137-962a-6416ade2af11" class="bulleted-list"><li style="list-style-type:disc">IP Addresses</li></ul><ul id="751983cf-a230-44be-a770-abe7e7aaf21f" class="bulleted-list"><li style="list-style-type:disc">Websites / Domains</li></ul><ul id="1604884f-dc1e-47b5-a297-63f32c34e1d4" class="bulleted-list"><li style="list-style-type:disc">Suspicious File locations</li></ul><ul id="39406ab5-9e01-45fc-84cd-2bef03425491" class="bulleted-list"><li style="list-style-type:disc">Malicious files, codes</li></ul></div></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="add32cac-32d5-4d1f-a21c-db95bbe74442" class="code"><code class="language-Shell">strings suspicious_file.exe | grep &quot;http”</code></pre><figure id="1c71c949-f540-4619-a239-5acec345ac70" class="image"><a href="image%204.png"><img style="width:622.828125px" src="image%204.png"/></a></figure><h3 id="4bc8ef8a-0e88-4df9-bf31-7d61561a10c2" class=""><strong>Key Options</strong></h3><ul id="2579cc24-e3e3-4bf1-97e7-93b09e075425" class="bulleted-list"><li style="list-style-type:disc"><code><strong>a</strong></code> or <code><strong>-all</strong></code>: Scan the entire file (default).</li></ul><ul id="a504d474-cb45-4da4-8f56-18b7ead4335c" class="bulleted-list"><li style="list-style-type:disc"><code><strong>n &lt;length&gt;</strong></code>: Minimum string length to display (default is 4 characters).<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="20b23016-b9fa-49f3-96b5-6dc7befe7aac" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">strings -n 8 file.bin</code></pre><ul id="27956ef8-3ddf-4ab9-ba89-cb0e084038b6" class="bulleted-list"><li style="list-style-type:circle">Displays strings with at least 8 characters.</li></ul></li></ul><ul id="6a3f628a-9100-4f78-a8e7-782e6a5fbdcb" class="bulleted-list"><li style="list-style-type:disc"><code><strong>e &lt;encoding&gt;</strong></code>: Specify the string encoding:<ul id="092188e2-9414-4aa4-94e6-be357ac3d064" class="bulleted-list"><li style="list-style-type:circle"><code>s</code> for single-byte (ASCII, default).</li></ul><ul id="a0fd64ce-bba0-4a95-b37e-eb2a339495b6" class="bulleted-list"><li style="list-style-type:circle"><code>b</code> for 16-bit big-endian Unicode.</li></ul><ul id="60c3b737-718a-4c6f-b210-9128526eb558" class="bulleted-list"><li style="list-style-type:circle"><code>l</code> for 16-bit little-endian Unicode.</li></ul></li></ul><ul id="06e771d0-53a0-4a22-b7e6-2d0ebed47e91" class="bulleted-list"><li style="list-style-type:disc"><code><strong>f</strong></code>: Show the file name before each string (useful for analyzing multiple files).</li></ul><hr id="7b4a2818-bdc1-449c-a980-241327ea1119"/><h3 id="90a24295-e194-4e0b-b8a1-3341c01f634a" class="">5 - Xorsearch tool</h3><p id="dfe289fb-5ff0-4b64-9ee7-f1d91a6f7453" class="">The next step, The <code><strong>xorsearch</strong></code><strong>,</strong> which is a powerful tool utility designed for analyzing binary files to identify and extract hidden data, particularly <strong>obfuscated or encoded strings</strong>. It’s often used in <strong>malware analysis</strong> and <strong>reverse engineering</strong> to locate patterns (e.g., keywords, URLs, commands) that are hidden through XOR or other basic encoding techniques.</p><hr id="12340b7c-4892-4100-bc24-ff630fd42541"/><h3 id="6f819eda-be80-44a2-8630-7784560fa83a" class=""><strong>Key Features of </strong><code><strong>xorsearch</strong></code></h3><ol type="1" id="7326e843-ed31-4a7c-89b5-ed28c9a4ac50" class="numbered-list" start="1"><li><strong>XOR Encoding Detection</strong>: Searches for patterns in files, even if they are XOR-encoded (a common obfuscation technique in malware).</li></ol><ol type="1" id="68982611-5a78-43b5-88e5-cac0b8bb6ab8" class="numbered-list" start="2"><li><strong>Custom Pattern Matching</strong>: Allows searching for specific text or binary patterns.</li></ol><ol type="1" id="8dd323af-f614-4eba-a576-3bf178154814" class="numbered-list" start="3"><li><strong>Supports Multiple Encoding Methods</strong>: In addition to XOR, it can handle <strong>ROT13</strong>, <strong>ROL/ROR</strong> (bitwise rotations), <strong>Base64</strong>, and others.</li></ol><ol type="1" id="188af7b5-febb-4edf-9ea4-a750291f78ec" class="numbered-list" start="4"><li><strong>Extract Hidden Data</strong>: Useful for uncovering obfuscated payloads or strings.</li></ol><hr id="85a24213-e808-49ad-8a1e-53b1ad35dc76"/><h3 id="6b0b5214-8168-45c6-913d-4de76e993937" class=""><strong>Installing </strong><code><strong>xorsearch</strong></code></h3><ol type="1" id="a27d6b45-06d5-40e6-9902-47f46abbb604" class="numbered-list" start="1"><li><strong>Clone the Repository</strong>:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b19ad4a4-4d46-407d-a998-c25ba6b1913a" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">git clone https://github.com/DidierStevens/DidierStevensSuite.git</code></pre><ul id="0ecfa744-7652-48b2-9371-7739f1df6d31" class="bulleted-list"><li style="list-style-type:disc">The tool is part of Didier Stevens’ suite of forensic tools.</li></ul></li></ol><ol type="1" id="c5f42610-a48f-4b64-be13-f602320691f1" class="numbered-list" start="2"><li><strong>Navigate to the Folder</strong>:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c87d5e71-6ba2-4b3f-81ee-fec99aab5ebd" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">cd DidierStevensSuite</code></pre></li></ol><ol type="1" id="9edcf2a5-a9f2-4799-9a5b-17ec751f054c" class="numbered-list" start="3"><li><strong>Run </strong><code><strong>xorsearch</strong></code>:<br/>No compilation is needed; it’s a standalone executable (on Windows) or can be run via Wine in Linux.<br/></li></ol><hr id="605d0d9d-df85-4384-b4c5-0511d7847d52"/><h3 id="81b27440-02a8-498a-9f05-ce51756b7d74" class=""><strong>Basic Usage of </strong><code><strong>xorsearch</strong></code></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e9f241a6-e2bf-4f9c-9deb-0260f01d393a" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">xorsearch [options] &lt;file&gt; &lt;search-term&gt;</code></pre><h3 id="d9d0fe43-2e5c-4853-aba4-37928173a2d0" class="">Example:</h3><ol type="1" id="97be5842-892e-4936-9330-157bdd8a8bc1" class="numbered-list" start="1"><li><strong>Search for Plaintext Patterns</strong>:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dea8b6c8-4bbf-445c-bd47-0b0d3c70f251" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">xorsearch malware.bin &quot;http&quot;</code></pre><ul id="8ef5c199-bf17-48ce-9a8b-a2d47ca54a99" class="bulleted-list"><li style="list-style-type:disc">Searches for the string &quot;http&quot; in the file, even if it’s XOR-encoded with a single key.</li></ul></li></ol><ol type="1" id="85a9a968-e676-4e38-9867-1d0239cdf8e5" class="numbered-list" start="2"><li><strong>Search for Obfuscated Strings</strong>:</li></ol><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2b0b68-fca8-4bb6-b9a5-3ca7bd6bddd9" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">xorsearch -x malware.bin &quot;password&quot;</code></pre><ul id="5ae72e7f-85be-4529-b98c-1d833dead273" class="bulleted-list"><li style="list-style-type:disc">Detects if &quot;password&quot; is XOR-encoded with any single-byte key.</li></ul><h3 id="2b0467a9-e06d-4447-9c9e-87f224de14e9" class=""><strong>Advanced Options</strong></h3><ul id="9c42d776-0652-4aae-b6cc-977d98cc5bf6" class="bulleted-list"><li style="list-style-type:disc"><code><strong>a</strong></code>: Show all matches (useful when multiple obfuscation layers exist).</li></ul><ul id="0e873e21-83b0-49e2-8ff2-9aa56594e189" class="bulleted-list"><li style="list-style-type:disc"><code><strong>e</strong></code>: Look for encoded strings (e.g., XOR, ROT13).</li></ul><ul id="ebc78f8d-7b48-43d1-b641-ae837ea1226e" class="bulleted-list"><li style="list-style-type:disc"><code><strong>c</strong></code>: Output only the offsets where matches are found.</li></ul><ul id="81a490b0-a7d8-4d9d-8276-150180bce6bb" class="bulleted-list"><li style="list-style-type:disc"><code><strong>i</strong></code>: Case-insensitive search.</li></ul><hr id="d6575ba6-a157-44d8-aa0d-43b9fb7b8b10"/><h2 id="66a71829-00d4-49a9-8f00-962c4abba2b3" class="">6 - Oletools</h2><p id="000b375b-a193-4dfe-b406-3c29ac8f34f8" class=""><strong>Oletools</strong> is a collection of Python tools to analyze Microsoft Office files (e.g., <code>.doc</code>, <code>.xls</code>, <code>.ppt</code>), OpenXML formats (<code>.docx</code>, <code>.xlsx</code>), and other files containing embedded OLE (Object Linking and Embedding) objects. These tools are commonly used in malware analysis, digital forensics, and cybersecurity to inspect documents for malicious content.</p><hr id="9711633c-20b3-47fb-adc7-c9778178d13d"/><h3 id="c043d517-f468-4aaf-a394-85633042933e" class=""><strong>Key Tools in Oletools</strong></h3><ol type="1" id="903a8f28-3918-4e5a-8f8f-541c51284d2c" class="numbered-list" start="1"><li><code><strong>oleid</strong></code>:<ul id="45ac5535-0053-4d54-a9bb-5a1aca1a4a1a" class="bulleted-list"><li style="list-style-type:disc">Purpose: Scans OLE and OpenXML files for common signs of malicious behavior (e.g., macros, embedded objects).</li></ul><ul id="0e46833e-25fd-4fed-9a75-9e97f911be9f" class="bulleted-list"><li style="list-style-type:disc">Example:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ee960b7e-732e-44f8-8526-5a52159c6091" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">oleid suspicious.doc</code></pre></li></ul></li></ol><ol type="1" id="cfb46c52-dd4a-4a03-ab8d-370313ee8825" class="numbered-list" start="2"><li><code><strong>olevba</strong></code>:<ul id="21e4ee3b-9e32-4cda-ada1-a9a406f07cda" class="bulleted-list"><li style="list-style-type:disc">Purpose: Extracts and analyzes VBA (Visual Basic for Applications) macros embedded in Office documents.</li></ul><ul id="ca8443de-54d0-44fe-8b39-372c60afc365" class="bulleted-list"><li style="list-style-type:disc">Example:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0f8b310d-2255-49b5-93e6-85648a754ca4" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">olevba malicious.doc</code></pre></li></ul></li></ol><ol type="1" id="a5d5ed20-5ac3-4c55-a495-3ca9d213826d" class="numbered-list" start="3"><li><code><strong>olemeta</strong></code>:<ul id="dde0b4f7-53ab-4a18-9c7c-7cc231e0ff91" class="bulleted-list"><li style="list-style-type:disc">Purpose: Extracts metadata (e.g., author, creation date, last modification) from OLE or OpenXML documents.</li></ul><ul id="f34d7f4a-8df7-4123-bb00-ac7706fc76ba" class="bulleted-list"><li style="list-style-type:disc">Example:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3f8e6fc9-f995-4847-8f69-857207f6a232" class="code"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">olemeta document.docx</code></pre></li></ul></li></ol><p id="17c01692-defe-8009-818e-c9617fee8126" class="">Below, is an example of how I used Oleid and Oleobj to check the risk report and find evidence of the malicious document. The “Description column is very useful”:</p><figure id="17c01692-defe-80cb-9a48-f122787c58ef" class="image"><a href="Linux_-_Maldoc_analysis_with_oleID_oleOBJ.png"><img style="width:622.984375px" src="Linux_-_Maldoc_analysis_with_oleID_oleOBJ.png"/></a></figure><p id="17c01692-defe-8024-aad2-caddd70689fe" class="">
</p><hr id="17c01692-defe-80aa-96be-c33f6c5ab1ce"/><h2 id="17b01692-defe-803f-be28-e5effd8dbf65" class="">Conclusion</h2><p id="17b01692-defe-8034-86ba-e7bdb2833b86" class="">Analyzing malicious documents is a vital skill for cybersecurity professionals, as attackers often exploit macros and document features to deliver malware or steal sensitive information. Tools like <strong>hash-checking utilities</strong>, <strong>ExifTool</strong>, and <strong>strings</strong> help identify anomalies such as suspicious metadata, embedded macros, and obfuscated content. Techniques such as hash verification and extracting readable strings provide critical insights into the document&#x27;s behavior and potential threats.</p><p id="17b01692-defe-8057-ba7e-cdcb7972a0a8" class="">Advanced tools like <strong>xorsearch</strong> and <strong>Oletools</strong> further enhance analysis by decoding obfuscation and identifying malicious VBA scripts or embedded objects. This comprehensive approach ensures that threats are identified effectively, enabling faster incident response and proactive risk mitigation. By mastering these tools and techniques, professionals can stay ahead of attackers and strengthen cybersecurity defenses.</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>