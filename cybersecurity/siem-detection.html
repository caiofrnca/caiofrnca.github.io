<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LetsDefend SIEM Lab: Phishing Alert – Cybersecurity Lab – Caio França</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body>
  <!-- HEADER / NAV -->
  <header class="site-header">
    <div class="container nav-container">
      <div class="logo">
        <a href="/">Caio<span>França</span></a>
      </div>
      <nav class="main-nav" id="mainNav">
        <a href="/">Home</a>
        <a href="/cybersecurity/">Cybersecurity</a>
        <a href="/networking/">Networking</a>
        <a href="/cloud/">Cloud</a>
        <a href="/ai/">AI &amp; Automation</a>
      </nav>
      <button class="nav-toggle" aria-label="Toggle navigation" onclick="toggleNav()">☰</button>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main>
    <section class="section">
      <div class="container">

        <!-- TITLE + SUMMARY -->
        <h1>LetsDefend SIEM Lab: Phishing Alert – Deceptive Mail Detected</h1>
        <p class="section-intro">
          In this lab I worked as a SOC analyst in the LetsDefend platform, investigating a phishing
          alert generated by a SIEM rule (<strong>SOC282 – Phishing Alert: Deceptive Mail Detected</strong>).
          The goal was to analyse the email, identify malicious artifacts, confirm impact on the user,
          and recommend appropriate containment and remediation actions.
        </p>

        <!-- OVERVIEW -->
        <article class="card">
          <h2>Overview</h2>
          <p>
            A phishing email with the subject “Free Coffee Voucher” was delivered to a user (Felix) from
            <code>free@coffeeshoop.com</code>. The SIEM raised an alert, but the email security product
            showed the action as <strong>allowed</strong>, meaning the message reached the user’s inbox.
          </p>
          <p>
            Acting as the analyst on duty, I took ownership of the ticket, followed the phishing playbook,
            analysed the email content, URLs, and attachment, and confirmed that the campaign was malicious
            and associated with <strong>AsyncRAT</strong> command-and-control activity.
          </p>
          <ul>
            <li><strong>Type:</strong> Blue team / SOC investigation</li>
            <li><strong>Focus:</strong> SIEM alert triage, phishing analysis, malware artefact review</li>
            <li><strong>Platform:</strong> LetsDefend SOC simulation (SIEM &amp; case management)</li>
            <li><strong>Status:</strong> Completed – alert classified as <strong>True Positive</strong></li>
          </ul>
        </article>

        <!-- OBJECTIVES -->
        <article class="card">
          <h2>Objectives</h2>
          <ul>
            <li>Investigate a SIEM-generated phishing alert in a simulated SOC environment.</li>
            <li>Apply a structured phishing playbook to ensure consistent incident handling.</li>
            <li>Analyse the email, URLs, and attachment to identify malicious behaviour and IOCs.</li>
            <li>Determine user impact, scope across the environment, and any C2 communication.</li>
            <li>Document findings, IOCs, and recommended remediation and awareness actions.</li>
          </ul>
        </article>

        <!-- ENVIRONMENT & TOOLS -->
        <article class="card">
          <h2>Environment &amp; Tools</h2>
          <p>
            The investigation was conducted entirely within the LetsDefend blue-team training platform,
            which simulates a SOC with alert queues, cases, and log visibility.
          </p>
          <ul>
            <li><strong>Environment:</strong> LetsDefend SOC – Monitoring &amp; Investigation channels</li>
            <li><strong>Data sources:</strong> Email security alerts, endpoint logs, network logs</li>
            <li><strong>Security tools:</strong> SIEM console, phishing playbook, log management views</li>
            <li><strong>External analysis:</strong> VirusTotal, Hybrid Analysis, AnyRun, URLHaus, URLScan</li>
          </ul>
        </article>

        <!-- METHODOLOGY -->
        <article class="card">
          <h2>Methodology</h2>
          <ol>
            <li><strong>Ticket triage:</strong> Reviewed the SOC ticket queue, filtered by severity, and took ownership
              of the phishing alert.</li>
            <li><strong>Case creation:</strong> Created and linked a case to track all investigative steps, findings,
              and decisions.</li>
            <li><strong>Playbook-driven workflow:</strong> Followed the phishing playbook to ensure each phase (email
              parsing, URL/attachment analysis, impact assessment) was covered.</li>
            <li><strong>Email analysis:</strong> Parsed headers, sender, recipient, timestamps, and observed the
              suspicious attachment and “Free Coffee” lure.</li>
            <li><strong>URL &amp; attachment analysis:</strong> Extracted URLs and the ZIP attachment link, analysed
              them using sandbox and threat intelligence tools.</li>
            <li><strong>Endpoint and network review:</strong> Correlated endpoint activity, browser history, and network
              logs for the victim host (Felix’s workstation at <code>172.16.20.151</code>).</li>
            <li><strong>Scope &amp; C2 check:</strong> Verified whether other users received the same email and looked
              for evidence of C2 communications in the environment.</li>
            <li><strong>Reporting &amp; closure:</strong> Documented IOCs, artefacts, and remediation recommendations,
              then closed the alert as a True Positive.</li>
          </ol>
        </article>

        <!-- KEY FINDINGS -->
        <article class="card">
          <h2>Key Findings</h2>
          <ul>
            <li>
              The phishing email successfully bypassed automated blocking and was delivered to Felix,
              increasing the risk of user interaction with the malicious content.
            </li>
            <li>
              URL and file analysis confirmed the attachment as <strong>malicious</strong>, associated
              with <strong>AsyncRAT</strong>, a remote access trojan used for full remote control of infected hosts.
            </li>
            <li>
              Threat intelligence revealed multiple concerning capabilities, such as process manipulation, VM detection,
              and outbound connections to a known malicious host (<code>37.120.233.226</code> on TCP/3451).
            </li>
            <li>
              Log review showed no evidence of the email being delivered to other users, and no lateral spread beyond
              Felix’s host.
            </li>
            <li>
              The investigation highlighted the importance of user awareness, better email filtering, and improved
              detection rules for phishing campaigns.
            </li>
          </ul>
        </article>

        <!-- SKILLS DEMONSTRATED -->
        <article class="card">
          <h2>Skills Demonstrated</h2>
          <ul class="tag-list">
            <li>SIEM</li>
            <li>SOC analysis</li>
            <li>Phishing investigation</li>
            <li>Log analysis</li>
            <li>Threat intelligence</li>
            <li>Incident response</li>
            <li>Playbook-driven workflow</li>
          </ul>
        </article>

        <!-- ARTIFACTS -->
        <article class="card">
          <h2>Artifacts &amp; IOCs</h2>
          <p>
            During the investigation, I collected and documented multiple indicators and technical artefacts,
            which would be valuable for future detections and threat hunting.
          </p>
          <ul>
            <li><strong>Sender:</strong> <code>free@coffeeshoop.com</code></li>
            <li><strong>Malicious attachment URL:</strong>
              <code>https://files-ld.s3.us-east-2.amazonaws.com/59cbd215-76ea-434d-93ca-4d6aec3bac98-free-coffee.zip</code>
            </li>
            <li><strong>Malware family:</strong> AsyncRAT (remote access trojan)</li>
            <li><strong>Suspicious IP:</strong> <code>37.120.233.226</code> (C2-related traffic)</li>
            <li><strong>File hash (example SHA256):</strong>
              <code>6f33ae4bf134c49faa14517a275c039ca1818b24fc2304649869e399ab2fb389</code>
            </li>
          </ul>
        </article>

        <!-- SNAPSHOTS -->

        <article class="card">
          <h2>Snapshots</h2>
          <p>
            Selected screenshots from the investigation show the SOC queue, case workflow,
            and phishing playbook used to structure the response.
          </p>

          <img src="../assets/img/cybersecurity/siem/1.png"
            alt="SIEM Monitoring dashboard showing active alerts across channels including phishing, brute-force, and data exfiltration detections"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/2.jpg"
            alt="SOC Investigation view with alert list and case creation workflow for EventID 93" class="lab-img"
            loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/3.jpg"
            alt="Investigation details panel showing phishing alert metadata and start of playbook sequence"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/4.png"
            alt="Playbook Step — Parse Email: questions required for initial phishing metadata extraction including sender, recipient and content indicators"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/5.png"
            alt="SIEM Investigation Channel highlighting SOC282 phishing alert with full email metadata such as SMTP source, sender address, subject line and action taken"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/6.png"
            alt="Email Security console displaying the phishing message with malicious ZIP attachment and embedded social-engineering lure"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/7.png"
            alt="Playbook prompt asking analyst to confirm presence of attachments or URLs in the suspicious phishing email"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/8.png"
            alt="Playbook instruction to analyze extracted URLs or attachments using third-party sandbox tools such as AnyRun, VirusTotal, URLScan and Hybrid Analysis"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/9.png"
            alt="Threat intelligence hit showing SilentBuilder-related domain activity linked to malicious downloader operations"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/10.png"
            alt="VirusTotal sandbox report for free-coffee.zip showing multiple AV detections and classification as malicious"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/11.png"
            alt="Hybrid Analysis detailed malware report confirming malicious ZIP file with SHA256 hash and multi-engine scan results"
            class="lab-img" loading="lazy" />

           <img src="../assets/img/cybersecurity/siem/12.png"
            alt="Firewall and network log showing user Felix downloading the malicious ZIP file from Amazon S3 including process name and connection details"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/13.png"
            alt="Email Security post-investigation panel showing the final automated action marking the phishing email as deleted"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/14.png"
            alt="Proxy log showing outbound connection from internal host 172.16.20.151 downloading the malicious ZIP file over port 443"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/15.png"
            alt="Endpoint process tree showing execution of Coffee.exe from user directory with parent process Explorer.exe and associated hash"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/16.png"
            alt="Browser history evidence showing user Felix accessed the malicious free-coffee.zip link prior to download"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/17.png"
            alt="Exchange log showing SMTP connection from suspicious source IP 103.80.134.63 to the internal email server delivering the phishing email"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/18.png"
            alt="IOC summary table listing malicious URL, SMTP sender IP, C2 IP address, and Coffee.exe malware hash extracted from analysis"
            class="lab-img" loading="lazy" />

          <img src="../assets/img/cybersecurity/siem/19.png"
            alt="Closed Alerts view showing SOC282 phishing alert classified as True Positive with documented playbook answers and analyst notes"
            class="lab-img" loading="lazy" />

      </div>
      </article>


      <!-- BACK LINK -->
      <p style="margin-top: 2rem;">
        <a href="/cybersecurity/">&larr; Back to Cybersecurity portfolio</a>
      </p>

      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container footer-content">
      <span>© <span id="year"></span> Caio França</span>
      <span>Cybersecurity Lab</span>
    </div>
  </footer>

  <script>
    // Mobile nav toggle
    function toggleNav() {
      const nav = document.getElementById('mainNav');
      if (nav) {
        nav.classList.toggle('open');
      }
    }

    // Dynamic year in footer
    const yearEl = document.getElementById('year');
    if (yearEl) {
      yearEl.textContent = new Date().getFullYear();
    }

    // ============================
    // LIGHTBOX GALLERY LOGIC
    // ============================
    (function () {
      const images = document.querySelectorAll('.lightbox-gallery img');
      if (!images.length) return;

      let currentIndex = 0;

      // Create overlay once, reuse for all images
      const overlay = document.createElement('div');
      overlay.className = 'lightbox-overlay';
      overlay.innerHTML = `
      <div class="lightbox-inner">
        <div class="lightbox-img-wrapper">
          <img class="lightbox-img" src="" alt="">
        </div>
        <div class="lightbox-caption"></div>
        <button class="lightbox-close" aria-label="Close">&times;</button>
        <button class="lightbox-prev" aria-label="Previous">&#8249;</button>
        <button class="lightbox-next" aria-label="Next">&#8250;</button>
      </div>
    `;
      document.body.appendChild(overlay);

      const imgEl = overlay.querySelector('.lightbox-img');
      const captionEl = overlay.querySelector('.lightbox-caption');
      const btnClose = overlay.querySelector('.lightbox-close');
      const btnPrev = overlay.querySelector('.lightbox-prev');
      const btnNext = overlay.querySelector('.lightbox-next');

      function openLightbox(index) {
        currentIndex = index;
        const img = images[currentIndex];
        imgEl.src = img.src;
        imgEl.alt = img.alt || '';
        captionEl.textContent = img.alt || '';
        overlay.classList.add('open');
      }

      function closeLightbox() {
        overlay.classList.remove('open');
      }

      function showNext(delta) {
        currentIndex = (currentIndex + delta + images.length) % images.length;
        openLightbox(currentIndex);
      }

      images.forEach((img, index) => {
        img.addEventListener('click', () => openLightbox(index));
      });

      btnClose.addEventListener('click', closeLightbox);
      btnPrev.addEventListener('click', () => showNext(-1));
      btnNext.addEventListener('click', () => showNext(1));

      // Close when clicking outside the image
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          closeLightbox();
        }
      });

      // Keyboard support
      document.addEventListener('keydown', (e) => {
        if (!overlay.classList.contains('open')) return;
        if (e.key === 'Escape') closeLightbox();
        if (e.key === 'ArrowRight') showNext(1);
        if (e.key === 'ArrowLeft') showNext(-1);
      });
    })();
  </script>


</body>

</html>